import{y as je,R as i,z as Te,j as T,N as Ae,l as _e,a as Le,f as te,r as Ne,A as Ie,_ as We,B as Ue}from"./index-24ae16bc.js";import{r as Me}from"./features-63f97d2a.js";var le={exports:{}},qe="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",De=qe,Fe=De;function pe(){}function fe(){}fe.resetWarningCache=pe;var Be=function(){function r(n,o,a,c,m,s){if(s!==Fe){var C=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw C.name="Invariant Violation",C}}r.isRequired=r;function e(){return r}var t={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:e,element:r,elementType:r,instanceOf:e,node:r,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:fe,resetWarningCache:pe};return t.PropTypes=t,t};le.exports=Be();var $e=le.exports;const u=je($e);function re(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(r,o).enumerable})),t.push.apply(t,n)}return t}function ne(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?re(Object(t),!0).forEach(function(n){de(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):re(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function B(r){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?B=function(e){return typeof e}:B=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},B(r)}function de(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function $(r,e){return Ye(r)||Ge(r,e)||ze(r,e)||Je()}function Ye(r){if(Array.isArray(r))return r}function Ge(r,e){var t=r&&(typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"]);if(t!=null){var n=[],o=!0,a=!1,c,m;try{for(t=t.call(r);!(o=(c=t.next()).done)&&(n.push(c.value),!(e&&n.length===e));o=!0);}catch(s){a=!0,m=s}finally{try{!o&&t.return!=null&&t.return()}finally{if(a)throw m}}return n}}function ze(r,e){if(r){if(typeof r=="string")return oe(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);if(t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set")return Array.from(r);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return oe(r,e)}}function oe(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=r[t];return n}function Je(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var H=function(e){var t=i.useRef(e);return i.useEffect(function(){t.current=e},[e]),t.current},A=function(e){return e!==null&&B(e)==="object"},He=function(e){return A(e)&&typeof e.then=="function"},Ke=function(e){return A(e)&&typeof e.elements=="function"&&typeof e.createToken=="function"&&typeof e.createPaymentMethod=="function"&&typeof e.confirmCardPayment=="function"},ae="[object Object]",Ve=function r(e,t){if(!A(e)||!A(t))return e===t;var n=Array.isArray(e),o=Array.isArray(t);if(n!==o)return!1;var a=Object.prototype.toString.call(e)===ae,c=Object.prototype.toString.call(t)===ae;if(a!==c)return!1;if(!a&&!n)return e===t;var m=Object.keys(e),s=Object.keys(t);if(m.length!==s.length)return!1;for(var C={},E=0;E<m.length;E+=1)C[m[E]]=!0;for(var S=0;S<s.length;S+=1)C[s[S]]=!0;var y=Object.keys(C);if(y.length!==m.length)return!1;var b=e,w=t,g=function(k){return r(b[k],w[k])};return y.every(g)},me=function(e,t,n){return A(e)?Object.keys(e).reduce(function(o,a){var c=!A(t)||!Ve(e[a],t[a]);return n.includes(a)?(c&&console.warn("Unsupported prop change: options.".concat(a," is not a mutable property.")),o):c?ne(ne({},o||{}),{},de({},a,e[a])):o},null):null},ve="Invalid prop `stripe` supplied to `Elements`. We recommend using the `loadStripe` utility from `@stripe/stripe-js`. See https://stripe.com/docs/stripe-js/react#elements-props-stripe for details.",se=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ve;if(e===null||Ke(e))return e;throw new Error(t)},Xe=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ve;if(He(e))return{tag:"async",stripePromise:Promise.resolve(e).then(function(o){return se(o,t)})};var n=se(e,t);return n===null?{tag:"empty"}:{tag:"sync",stripe:n}},Qe=function(e){!e||!e._registerWrapper||!e.registerAppInfo||(e._registerWrapper({name:"react-stripe-js",version:"2.4.0"}),e.registerAppInfo({name:"react-stripe-js",version:"2.4.0",url:"https://stripe.com/docs/stripe-js/react"}))},he=i.createContext(null);he.displayName="CustomCheckoutSdkContext";var Ze=function(e,t){if(!e)throw new Error("Could not find CustomCheckoutProvider context; You need to wrap the part of your app that ".concat(t," in an <CustomCheckoutProvider> provider."));return e},et=i.createContext(null);et.displayName="CustomCheckoutContext";u.any,u.shape({clientSecret:u.string.isRequired,elementsOptions:u.object}).isRequired;var K=function(e){var t=i.useContext(he),n=i.useContext(Y);if(t&&n)throw new Error("You cannot wrap the part of your app that ".concat(e," in both <CustomCheckoutProvider> and <Elements> providers."));return t?Ze(t,e):Ce(n,e)},Y=i.createContext(null);Y.displayName="ElementsContext";var Ce=function(e,t){if(!e)throw new Error("Could not find Elements context; You need to wrap the part of your app that ".concat(t," in an <Elements> provider."));return e},V=i.createContext(null);V.displayName="CartElementContext";var tt=function(e,t){if(!e)throw new Error("Could not find Elements context; You need to wrap the part of your app that ".concat(t," in an <Elements> provider."));return e},ye=function(e){var t=e.stripe,n=e.options,o=e.children,a=i.useMemo(function(){return Xe(t)},[t]),c=i.useState(null),m=$(c,2),s=m[0],C=m[1],E=i.useState(null),S=$(E,2),y=S[0],b=S[1],w=i.useState(function(){return{stripe:a.tag==="sync"?a.stripe:null,elements:a.tag==="sync"?a.stripe.elements(n):null}}),g=$(w,2),l=g[0],k=g[1];i.useEffect(function(){var x=!0,N=function(I){k(function(W){return W.stripe?W:{stripe:I,elements:I.elements(n)}})};return a.tag==="async"&&!l.stripe?a.stripePromise.then(function(j){j&&x&&N(j)}):a.tag==="sync"&&!l.stripe&&N(a.stripe),function(){x=!1}},[a,l,n]);var O=H(t);i.useEffect(function(){O!==null&&O!==t&&console.warn("Unsupported prop change on Elements: You cannot change the `stripe` prop after setting it.")},[O,t]);var R=H(n);return i.useEffect(function(){if(l.elements){var x=me(n,R,["clientSecret","fonts"]);x&&l.elements.update(x)}},[n,R,l.elements]),i.useEffect(function(){Qe(l.stripe)},[l.stripe]),i.createElement(Y.Provider,{value:l},i.createElement(V.Provider,{value:{cart:s,setCart:C,cartState:y,setCartState:b}},o))};ye.propTypes={stripe:u.any,options:u.object};var rt=function(e){var t=i.useContext(Y);return Ce(t,e)},nt={cart:null,cartState:null,setCart:function(){},setCartState:function(){}},ie=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=i.useContext(V);return t?nt:tt(n,e)},ot=function(){var e=rt("calls useElements()"),t=e.elements;return t},at=function(){var e=K("calls useStripe()"),t=e.stripe;return t};u.func.isRequired;var h=function(e,t,n){var o=!!n,a=i.useRef(n);i.useEffect(function(){a.current=n},[n]),i.useEffect(function(){if(!o||!e)return function(){};var c=function(){a.current&&a.current.apply(a,arguments)};return e.on(t,c),function(){e.off(t,c)}},[o,t,e,a])},st=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},p=function(e,t){var n="".concat(st(e),"Element"),o=function(s){var C=s.id,E=s.className,S=s.options,y=S===void 0?{}:S,b=s.onBlur,w=s.onFocus,g=s.onReady,l=s.onChange,k=s.onEscape,O=s.onClick,R=s.onLoadError,x=s.onLoaderStart,N=s.onNetworksChange,j=s.onCheckout,I=s.onLineItemClick,W=s.onConfirm,be=s.onCancel,xe=s.onShippingAddressChange,ke=s.onShippingRateChange,_=K("mounts <".concat(n,">")),U="elements"in _?_.elements:null,M="customCheckoutSdk"in _?_.customCheckoutSdk:null,Pe=i.useState(null),X=$(Pe,2),v=X[0],we=X[1],P=i.useRef(null),G=i.useRef(null),Q=ie("mounts <".concat(n,">"),"customCheckoutSdk"in _),z=Q.setCart,J=Q.setCartState;h(v,"blur",b),h(v,"focus",w),h(v,"escape",k),h(v,"click",O),h(v,"loaderror",R),h(v,"loaderstart",x),h(v,"networkschange",N),h(v,"lineitemclick",I),h(v,"confirm",W),h(v,"cancel",be),h(v,"shippingaddresschange",xe),h(v,"shippingratechange",ke);var q;e==="cart"?q=function(ee){J(ee),g&&g(ee)}:g&&(e==="expressCheckout"?q=g:q=function(){g(v)}),h(v,"ready",q);var Oe=e==="cart"?function(d){J(d),l&&l(d)}:l;h(v,"change",Oe);var Re=e==="cart"?function(d){J(d),j&&j(d)}:j;h(v,"checkout",Re),i.useLayoutEffect(function(){if(P.current===null&&G.current!==null&&(U||M)){var d=null;M?d=M.createElement(e,y):U&&(d=U.create(e,y)),e==="cart"&&z&&z(d),P.current=d,we(d),d&&d.mount(G.current)}},[U,M,y,z]);var Z=H(y);return i.useEffect(function(){if(P.current){var d=me(y,Z,["paymentRequest"]);d&&P.current.update(d)}},[y,Z]),i.useLayoutEffect(function(){return function(){if(P.current&&typeof P.current.destroy=="function")try{P.current.destroy(),P.current=null}catch{}}},[]),i.createElement("div",{id:C,className:E,ref:G})},a=function(s){var C=K("mounts <".concat(n,">"));ie("mounts <".concat(n,">"),"customCheckoutSdk"in C);var E=s.id,S=s.className;return i.createElement("div",{id:E,className:S})},c=t?a:o;return c.propTypes={id:u.string,className:u.string,onChange:u.func,onBlur:u.func,onFocus:u.func,onReady:u.func,onEscape:u.func,onClick:u.func,onLoadError:u.func,onLoaderStart:u.func,onNetworksChange:u.func,onCheckout:u.func,onLineItemClick:u.func,onConfirm:u.func,onCancel:u.func,onShippingAddressChange:u.func,onShippingRateChange:u.func,options:u.object},c.displayName=n,c.__elementType=e,c},f=typeof window>"u",it=i.createContext(null);it.displayName="EmbeddedCheckoutProviderContext";p("auBankAccount",f);p("card",f);p("cardNumber",f);p("cardExpiry",f);p("cardCvc",f);p("fpxBank",f);p("iban",f);p("idealBank",f);p("p24Bank",f);p("epsBank",f);var ut=p("payment",f);p("expressCheckout",f);p("paymentRequestButton",f);p("linkAuthentication",f);p("address",f);p("shippingAddress",f);p("cart",f);p("paymentMethodMessaging",f);p("affirmMessage",f);p("afterpayClearpayMessage",f);var Se="https://js.stripe.com/v3",ct=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,ue="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",lt=function(){for(var e=document.querySelectorAll('script[src^="'.concat(Se,'"]')),t=0;t<e.length;t++){var n=e[t];if(ct.test(n.src))return n}return null},ce=function(e){var t=e&&!e.advancedFraudSignals?"?advancedFraudSignals=false":"",n=document.createElement("script");n.src="".concat(Se).concat(t);var o=document.head||document.body;if(!o)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return o.appendChild(n),n},pt=function(e,t){!e||!e._registerWrapper||e._registerWrapper({name:"stripe-js",version:"2.2.1",startTime:t})},L=null,D=null,F=null,ft=function(e){return function(){e(new Error("Failed to load Stripe.js"))}},dt=function(e,t){return function(){window.Stripe?e(window.Stripe):t(new Error("Stripe.js not available"))}},mt=function(e){return L!==null?L:(L=new Promise(function(t,n){if(typeof window>"u"||typeof document>"u"){t(null);return}if(window.Stripe&&e&&console.warn(ue),window.Stripe){t(window.Stripe);return}try{var o=lt();if(o&&e)console.warn(ue);else if(!o)o=ce(e);else if(o&&F!==null&&D!==null){var a;o.removeEventListener("load",F),o.removeEventListener("error",D),(a=o.parentNode)===null||a===void 0||a.removeChild(o),o=ce(e)}F=dt(t,n),D=ft(n),o.addEventListener("load",F),o.addEventListener("error",D)}catch(c){n(c);return}}),L.catch(function(t){return L=null,Promise.reject(t)}))},vt=function(e,t,n){if(e===null)return null;var o=e.apply(void 0,t);return pt(o,n),o},ge=Promise.resolve().then(function(){return mt(null)}),Ee=!1;ge.catch(function(r){Ee||console.warn(r)});var ht=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];Ee=!0;var o=Date.now();return ge.then(function(a){return vt(a,t,o)})};const Ct=ht("pk_test_51Ol50OSF81mdFwf55LG3h0GbGTmAyCQ7pHP0SEttaokfqU3Y3wz0voyLTEunvS0Cs2kx1tJpJ6LzSTmLMTTtYx920045qSgaTc"),yt=()=>{const r=at(),e=ot(),t=_e(),n=Le(),{user:o}=te(l=>l.userReducer),{shippingInfo:a,cartItems:c,subtotal:m,tax:s,discount:C,shippingCharges:E,total:S}=te(l=>l.cartReducer),[y,b]=Ne.useState(!1),[w]=Ie(),g=async l=>{if(l.preventDefault(),!r||!e)return;b(!0);const k={shippingInfo:a,orderItems:c,subtotal:m,tax:s,discount:C,shippingCharges:E,total:S,user:o==null?void 0:o._id},{paymentIntent:O,error:R}=await r.confirmPayment({elements:e,confirmParams:{return_url:window.location.origin},redirect:"if_required"});if(R)return b(!1),We.error(R.message||"Something Went Wrong");if(O.status==="succeeded"){const x=await w(k);n(Ue()),Me(x,t,"/orders")}b(!1)};return T.jsx("div",{className:"checkout-container",children:T.jsxs("form",{onSubmit:g,children:[T.jsx(ut,{}),T.jsx("button",{type:"submit",disabled:y,children:y?"Processing...":"Pay"})]})})},Et=()=>{const e=Te().state;return e?T.jsx(ye,{options:{clientSecret:e},stripe:Ct,children:T.jsx(yt,{})}):T.jsx(Ae,{to:"/shipping"})};export{Et as default};
